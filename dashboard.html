<!-- Add to head -->
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

<!-- Update auth form -->
<div class="auth-container" id="authContainer">
    <div class="auth-form">
        <h2>Login to Bot Forge</h2>
        <input type="email" id="email" placeholder="Email">
        <input type="password" id="password" placeholder="Password">
        <button class="cta-button" onclick="login()">Login</button>
        <button class="cta-button" onclick="register()">Register</button>
    </div>
</div>

<!-- Update script -->
<script>
    let token = localStorage.getItem('token');

    function checkAuth() {
        if (!token) {
            authContainer.style.display = 'flex';
            gsap.from('.auth-form', { scale: 0.8, opacity: 0, duration: 0.5, ease: 'back.out(1.7)' });
        }
    }

    async function register() {
        const email = document.getElementById('email').value;
        const password = document.getElementById('password').value;
        
        try {
            await axios.post('http://localhost:3000/api/register', { email, password });
            alert('Registered successfully! Please login.');
        } catch (error) {
            alert(error.response.data.error);
        }
    }

    async function login() {
        const email = document.getElementById('email').value;
        const password = document.getElementById('password').value;
        
        try {
            const response = await axios.post('http://localhost:3000/api/login', { email, password });
            token = response.data.token;
            localStorage.setItem('token', token);
            
            gsap.to('.auth-form', {
                scale: 0.8,
                opacity: 0,
                duration: 0.5,
                onComplete: () => authContainer.style.display = 'none'
            });
        } catch (error) {
            alert(error.response.data.error);
        }
    }

    async function createBot() {
        if (!token) {
            checkAuth();
            return;
        }

        const botName = document.getElementById('botName').value;
        const prefix = document.getElementById('botPrefix').value;
        const commandType = document.getElementById('commandType').value;

        try {
            const response = await axios.post('http://localhost:3000/api/create-bot', 
                { name: botName, prefix, commandType },
                { headers: { Authorization: `Bearer ${token}` } }
            );

            const preview = document.getElementById('botPreview');
            const newMessage = document.createElement('div');
            newMessage.className = 'chat-message';
            newMessage.textContent = `${prefix}help - ${commandType} bot created!`;
            preview.appendChild(newMessage);

            gsap.from(newMessage, { x: 50, opacity: 0, duration: 0.5, ease: 'power2.out' });
        } catch (error) {
            alert(error.response.data.error);
        }
    }
</script>
